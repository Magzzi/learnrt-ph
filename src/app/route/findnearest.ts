const stations = [
  // LRT 1
  { name: "LRT 1 Baclaran", lat: 14.534567416074673, lng: 120.99842057227043 }, // 14.534567416074673, 120.99842057227043
  { name: "LRT 1 EDSA", lat: 14.538756710794676, lng: 121.00067384561713 }, // 14.538756710794676, 121.00067384561713
  { name: "LRT 1 Libertad", lat: 14.549081378574467, lng: 120.99877241534934 }, // 14.549081378574467, 120.99877241534934
  { name: "LRT 1 Gil Puyat", lat: 14.553799541142391, lng: 120.99721427819544 }, // 14.553799541142391, 120.99721427819544
  { name: "LRT 1 Vito Cruz", lat: 14.563635141111982, lng: 120.99489431013075 }, // 14.563635141111982, 120.99489431013075
  { name: "LRT 1 Quirino", lat: 14.570507661680907, lng: 120.99159218129492 }, // 14.570507661680907, 120.99159218129492
  { name: "LRT 1 Pedro Gil", lat: 14.576698539343393, lng: 120.988105681295 }, // 14.576698539343393, 120.988105681295
  { name: "LRT 1 United Nations", lat: 14.5827472669176, lng: 120.98450297759017 }, // 14.5827472669176, 120.98450297759017
  { name: "LRT 1 Central Terminal", lat: 14.593053084997939, lng: 120.98156862177076 }, // 14.593053084997939, 120.98156862177076
  { name: "LRT 1 Carriedo", lat: 14.599103810263072, lng: 120.98139436780372 }, // 14.599103810263072, 120.98139436780372
  { name: "LRT 1 Doroteo Jose", lat: 14.605672210615777, lng: 120.98209203896776 }, // 14.605672210615777, 120.98209203896776
  { name: "LRT 1 Bambang", lat: 14.611436732349889, lng: 120.98243665060724 }, // 14.611436732349889, 120.98243665060724
  { name: "LRT 1 Tayuman", lat: 14.616900928244707, lng: 120.98271483711552 }, // 14.616900928244707, 120.98271483711552
  { name: "LRT 1 Blumentritt", lat: 14.622824649609989, lng: 120.98282759293541 }, // 14.622824649609989, 120.98282759293541
  { name: "LRT 1 Abad Santos", lat: 14.630834928462365, lng: 120.98131470642745 }, // 14.630834928462365, 120.98131470642745
  { name: "LRT 1 R. Papa", lat: 14.636360599442654, lng: 120.98232093711611 }, // 14.636360599442654, 120.98232093711611
  { name: "LRT 1 5th Avenue", lat: 14.644887412490847, lng: 120.98354283896869 }, // 14.644887412490847, 120.98354283896869
  { name: "LRT 1 Monumento", lat: 14.654517582234087, lng: 120.98384199478873 }, // 14.654517582234087, 120.98384199478873
  { name: "LRT 1 Balintawak", lat: 14.657801414859744, lng: 121.00409908129687 }, // 14.657801414859744, 121.00409908129687
  { name: "LRT 1 Fernando Poe Jr.", lat: 14.657853697740482, lng: 121.02116516780518 }, // 14.657853697740482, 121.02116516780518


  // LRT 1 Cavite Extension
  { name: "LRT 1 Redemptorist", lat: 14.530991298474941, lng: 120.99297213896598 }, // 14.530991298474941, 120.99297213896598
  { name: "LRT 1 MIA (NAIA)", lat: 14.518769991546883, lng: 120.99293288004228 }, // 14.518769991546883, 120.99293288004228
  { name: "LRT 1 PITX", lat: 14.508475260671405, lng: 120.99127361996197 }, // 14.508475260671405, 120.99127361996197
  { name: "LRT 1 Ninoy Aquino", lat: 14.499060621687235, lng: 120.99433563896534 }, // 14.499060621687235, 120.99433563896534
  { name: "LRT 1 Dr. Santos", lat: 14.484707366714177, lng: 120.98923482362069 }, // 14.484707366714177, 120.98923482362069
  
  // LRT 2
  { name: "LRT 2 Recto", lat: 14.603712211706654, lng: 120.9829667763509 }, // 14.603712211706654, 120.9829667763509
  { name: "LRT 2 Legarda", lat: 14.601119762186297, lng: 120.99256499478733 }, // 14.601119762186297, 120.99256499478733
  { name: "LRT 2 Pureza", lat: 14.602016225789791, lng: 121.00512445060718 }, // 14.602016225789791, 121.00512445060718
  { name: "LRT 2 V. Mapa", lat: 14.604429858432995, lng: 121.01713513711529 }, // 14.604429858432995, 121.01713513711529
  { name: "LRT 2 J. Ruiz", lat: 14.611051916249387, lng: 121.02633714082035 }, // 14.611051916249387, 121.02633714082035
  { name: "LRT 2 Gilmore", lat: 14.613842238270218, lng: 121.0341540371156 }, // 14.613842238270218, 121.0341540371156
  { name: "LRT 2 Betty Go-Belmonte", lat: 14.618666027075362, lng: 121.04271672362391 }, //14.618666027075362, 121.04271672362391
  { name: "LRT 2 Cubao", lat: 14.622955463609953, lng: 121.0525368628623 }, // 14.622955463609953, 121.0525368628623
  { name: "LRT 2 Anonas", lat: 14.628315036665292, lng: 121.06478418129625 }, // 14.628315036665292, 121.06478418129625
  { name: "LRT 2 Katipunan", lat: 14.631356227870166, lng: 121.07258772547651 }, // 14.631356227870166, 121.07258772547651
  { name: "LRT 2 Santolan", lat: 14.608077036319974, lng: 121.05641439478754 }, // 14.608077036319974, 121.05641439478754
  { name: "LRT 2 Marikina - Pasig", lat: 14.620563270104466, lng: 121.1002427082796 }, // 14.620563270104466, 121.1002427082796
  { name: "LRT 2 Antipolo", lat: 14.625235434822441, lng: 121.121421081296 }, // 14.625235434822441, 121.121421081296

  // MRT 3
  { name: "MRT 3 North Avenue", lat: 14.652408724009861, lng: 121.03245101198539 }, // 14.652408724009861, 121.03245101198539
  { name: "MRT 3 Quezon Avenue", lat: 14.642983993161806, lng: 121.03822593896844 }, // 14.642983993161806, 121.03822593896844
  { name: "MRT 3 Kamuning", lat: 14.635192033778434, lng: 121.04337818607327 }, // 14.635192033778434, 121.04337818607327
  { name: "MRT 3 Cubao", lat: 14.619741205186642, lng: 121.05114699462943 }, // 14.619741205186642, 121.05114699462943
  { name: "MRT 3 Santolan", lat: 14.608077036319974, lng: 121.05631783526299 }, // 14.608077036319974, 121.05631783526299
  { name: "MRT 3 Ortigas", lat: 14.586818097219796, lng: 121.05618279293456 }, // 14.586818097219796, 121.05618279293456
  { name: "MRT 3 Shaw Boulevard", lat: 14.582090850246962, lng: 121.05379317944264 }, // 14.582090850246962, 121.05379317944264
  { name: "MRT 3 Boni", lat: 14.573767735974076, lng: 121.04813816658928 }, // 14.573767735974076, 121.04813816658928
  { name: "MRT 3 Guadalupe", lat: 14.566667575571289, lng: 121.04543001927169 }, // 14.566667575571289, 121.04543001927169
  { name: "MRT 3 Buendia", lat: 14.554816291938682, lng: 121.03448963896655 }, // 14.554816291938682, 121.03448963896655
  { name: "MRT 3 Ayala", lat: 14.549368527238519, lng: 121.02775236780244 }, // 14.549368527238519, 121.02775236780244
  { name: "MRT 3 Magallanes", lat: 14.54229289899891, lng: 121.01942082176961 }, // 14.54229289899891, 121.01942082176961
  { name: "MRT 3 Taft Avenue", lat: 14.537855921780142, lng: 121.00222833896616 }, // 14.537855921780142, 121.00222833896616

  // MRT 7 (under construction)
  { name: "MRT 7 North Triangle Common Station", lat: 14.655349121875837, lng: 121.03092905246072 }, // 14.655349121875837, 121.03092905246072
  { name: "MRT 7 Quezon Memorial Circle", lat: 14.651710744811963, lng: 121.04929883711642 }, // 14.651710744811963, 121.04929883711642
  { name: "MRT 7 University Avenue", lat: 14.655188740159943, lng: 121.05446279293625 }, // 14.655188740159943, 121.05446279293625
  { name: "MRT 7 Tandang Sora", lat: 14.663550737129713, lng: 121.06741480704916 }, // 14.663550737129713, 121.06741480704916
  { name: "MRT 7 Don Antonio", lat: 14.67716807574495, lng: 121.08262723711707 }, // 14.67716807574495, 121.08262723711707
  { name: "MRT 7 Batasan", lat: 14.685359358234765, lng: 121.08630496595336 }, // 14.685359358234765, 121.08630496595336
  { name: "MRT 7 Manggahan", lat: 14.697434274752808, lng: 121.0872510929373 }, // 14.697434274752808, 121.0872510929373
  { name: "MRT 7 Doña Carmen", lat: 14.705245288881681, lng: 121.07828449478994 }, // 14.705245288881681, 121.07828449478994
  { name: "MRT 7 Regalado Avenue", lat: 14.70675779668904, lng: 121.06803502362594 }, // 14.70675779668904, 121.06803502362594
  { name: "MRT 7 Mindanao Avenue", lat: 14.733145435745321, lng: 121.06116020828225 }, // 14.733145435745321, 121.06116020828225
  { name: "MRT 7 Quirino Highway", lat: 14.735672657003834, lng: 121.06690923897084 }, // 14.735672657003834, 121.06690923897084
  { name: "MRT 7 Sacred Heart", lat: 14.75074551644135, lng: 121.08395293711874 }, // 14.75074551644135, 121.08395293711874
  { name: "MRT 7 Tala", lat: 14.766069176051921, lng: 121.08503049479127 }, // 14.766069176051921, 121.08503049479127
  { name: "MRT 7 San Jose del Monte", lat: 14.784567879281402, lng: 121.07481978129992 }, // 14.784567879281402, 121.07481978129992

//   // PNR
//   { name: "PNR Tutuban", lat: 0.00, lng: 0.00 }, // 14.611506930583579, 120.97307147600094
//   { name: "PNR Blumentritt", lat: 0.00, lng: 0.00 }, // 14.622781531878612, 120.9836718088951
//   { name: "PNR España", lat: 0.00, lng: 0.00 }, // 14.612570849198372, 120.99690273711545
//   { name: "PNR Sta. Mesa", lat: 0.00, lng: 0.00 }, // 14.60108009642735, 121.01036722238345
//   { name: "PNR Paco", lat: 0.00, lng: 0.00 }, // 14.579692269656636, 120.999428552459
//   { name: "PNR San Andres", lat: 0.00, lng: 0.00 }, // 14.573464242546827, 120.99938212177034
//   { name: "PNR Vito Cruz", lat: 0.00, lng: 0.00 }, // 14.567422848528485, 121.0028717812948
//   { name: "PNR Dela Rosa", lat: 0.00, lng: 0.00 }, // 14.557970232971938, 121.00797369478634
//   { name: "PNR EDSA", lat: 0.00, lng: 0.00 }, // 14.541174833796301, 121.01668458129409
//   { name: "PNR Nichols", lat: 0.00, lng: 0.00 },
//   { name: "PNR FTI", lat: 0.00, lng: 0.00 },
//   { name: "PNR Bicutan", lat: 0.00, lng: 0.00 },
//   { name: "PNR Sucat", lat: 0.00, lng: 0.00 },
//   { name: "PNR Alabang", lat: 0.00, lng: 0.00 },
//   { name: "PNR Muntinlupa", lat: 0.00, lng: 0.00 },
//   { name: "PNR Tunasan", lat: 0.00, lng: 0.00 },
];


export const getCoordinates = async (location: string) => {
  const res = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(location)}&format=json`);
  const data = await res.json();
  if (data.length === 0) return null;
  return { lat: parseFloat(data[0].lat), lng: parseFloat(data[0].lon) };
};

function getDistance(lat1: number, lon1: number, lat2: number, lon2: number) {
  const R = 6371; // Radius of Earth in km
  const dLat = (lat2 - lat1) * (Math.PI / 180);
  const dLon = (lon2 - lon1) * (Math.PI / 180);
  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(lat1 * (Math.PI / 180)) *
      Math.cos(lat2 * (Math.PI / 180)) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}


export const findNearestStations = (userLat: number, userLng: number) => {
  const nearest = stations
    .map((station) => ({
      ...station,
      distance: getDistance(userLat, userLng, station.lat, station.lng),
    }))
    .sort((a, b) => a.distance - b.distance)
    .slice(0, 3)
    .map(station => ({
      name: station.distance <= 100 ? station.name : " ",
      distance: station.distance <= 100 ? station.distance : 0,
    }));

  return nearest;
};
